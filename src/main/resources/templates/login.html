<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Iniciar Sesión</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">
    <div th:replace="fragments/navbar :: navbar"></div>

    <main class="container py-5">
      <div
        class="row justify-content-center"
        style="min-height: calc(100vh - 160px)"
      >
        <div class="col-12 col-sm-10 col-md-8 col-lg-5">
          <div class="card shadow p-4">
            <h1 class="h3 text-center mb-3">Bienvenido de nuevo</h1>
            <p class="text-muted text-center mb-4">
              Inicia sesión para continuar con tu compra.
            </p>

            <div th:if="${param.error}" class="alert alert-danger">
              Usuario o contraseña incorrectos.
            </div>
            <div th:if="${param.logout}" class="alert alert-success">
              Cerraste sesión correctamente.
            </div>

            <form
              th:action="@{/login}"
              method="post"
              class="needs-validation"
              novalidate
            >
              <div class="mb-3">
                <label for="username" class="form-label"
                  >Correo electrónico o usuario</label
                >
                <input
                  id="username"
                  name="username"
                  type="text"
                  class="form-control"
                  placeholder="usuario@ejemplo.com"
                  required
                  autofocus
                />
                <div class="invalid-feedback">
                  Ingresa tu usuario o correo electrónico.
                </div>
              </div>

              <div class="mb-3">
                <label for="password" class="form-label">Contraseña</label>
                <input
                  id="password"
                  name="password"
                  type="password"
                  class="form-control"
                  placeholder="••••••••"
                  required
                />
                <div class="invalid-feedback">Ingresa tu contraseña.</div>
              </div>

              <div
                class="d-flex justify-content-between align-items-center mb-3"
              >
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="rememberMe"
                    name="remember-me"
                  />
                  <label class="form-check-label" for="rememberMe"
                    >Recordarme</label
                  >
                </div>
                <a href="#" class="small text-decoration-none"
                  >¿Olvidaste tu contraseña?</a
                >
              </div>

              <button type="submit" class="btn btn-primary w-100">
                Iniciar sesión
              </button>
            </form>

            <p class="text-center mt-4 mb-0 small">
              ¿No tienes cuenta?
              <a th:href="@{/registro}" class="text-decoration-none"
                >Crear cuenta</a
              >
            </p>
          </div>
        </div>
      </div>
    </main>

    <script>
      // Bootstrap validation helper to give immediate feedback
      (function () {
        "use strict";
        const forms = document.querySelectorAll(".needs-validation");
        Array.prototype.slice.call(forms).forEach(function (form) {
          form.addEventListener(
            "submit",
            function (event) {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add("was-validated");
            },
            false
          );
        });
      })();
    </script>
  </body>
</html>
